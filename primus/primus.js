!function(t,e,n,r){e[t]=n.call(e);for(var o=0;o<r.length;o++)r[o](e[t]);"undefined"!=typeof module&&module.exports?module.exports=e[t]:"function"==typeof define&&define.amd&&define(function(){return e[t]})}("Primus",this||{},function(){return function r(o,i,s){function c(e,t){if(!i[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(a)return a(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=i[e]={exports:{}},o[e][0].call(n.exports,function(t){return c(o[e][1][t]||t)},n,n.exports,r,o,i,s)}return i[e].exports}for(var a="function"==typeof require&&require,t=0;t<s.length;t++)c(s[t]);return c}({1:[function(t,e,n){"use strict";e.exports=function(r,i){var s=/[, ]+/;function o(t,e){if(i[t]){if("string"==typeof i[t]&&(i[t]=i[t].split(s)),"function"==typeof i[t])return i[t].call(e);for(var n,r,o=0;o<i[t].length;o++)"function"==(n=typeof(r=i[t][o]))?r.call(e):"string"==n&&"function"==typeof e[r]&&e[r]()}}return i=i||{},"string"==typeof(r=r||[])&&(r=r.split(s)),function(){var t,e=this,n=0;if(null===e[r[0]])return!1;for(o("before",e);n<r.length;n++)e[t=r[n]]&&("function"==typeof e[t].destroy&&e[t].destroy(),e[t]=null);return e.emit&&e.emit("destroy"),o("after",e),!0}}},{}],2:[function(t,e,n){"use strict";e.exports=function(){for(var r,o=this,t=0,e=arguments.length,i=new Array(e);t<e;t++)i[t]=arguments[t];return"function"!=typeof i[i.length-1]?function(){for(var t=0,e=arguments.length,n=new Array(e);t<e;t++)n[t]=arguments[t];return o.emit.apply(o,i.concat(n))}:(r=i.pop(),function(){for(var t=0,e=arguments.length,n=new Array(e+1);t<e;t++)n[t+1]=arguments[t];return n[0]=function(t,e){if(t)return o.emit("error",t);n=void 0===e?n.slice(1):null===e?[]:e,o.emit.apply(o,i.concat(n))},r.apply(o,n),!0})}},{}],3:[function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,h="~";function o(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");o=new i(n,r||t,o),e=h?h+e:e;return t._events[e]?t._events[e].fn?t._events[e]=[t._events[e],o]:t._events[e].push(o):(t._events[e]=o,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new o:delete t._events[e]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(h=!1)),c.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(h?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},c.prototype.listeners=function(t){var t=h?h+t:t,e=this._events[t];if(!e)return[];if(e.fn)return[e.fn];for(var n=0,r=e.length,o=new Array(r);n<r;n++)o[n]=e[n].fn;return o},c.prototype.listenerCount=function(t){t=h?h+t:t,t=this._events[t];return t?t.fn?1:t.length:0},c.prototype.emit=function(t,e,n,r,o,i){var s=h?h+t:t;if(!this._events[s])return!1;var c,a=this._events[s],u=arguments.length;if(a.fn){switch(a.once&&this.removeListener(t,a.fn,void 0,!0),u){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,e),!0;case 3:return a.fn.call(a.context,e,n),!0;case 4:return a.fn.call(a.context,e,n,r),!0;case 5:return a.fn.call(a.context,e,n,r,o),!0;case 6:return a.fn.call(a.context,e,n,r,o,i),!0}for(l=1,c=new Array(u-1);l<u;l++)c[l-1]=arguments[l];a.fn.apply(a.context,c)}else for(var f,p=a.length,l=0;l<p;l++)switch(a[l].once&&this.removeListener(t,a[l].fn,void 0,!0),u){case 1:a[l].fn.call(a[l].context);break;case 2:a[l].fn.call(a[l].context,e);break;case 3:a[l].fn.call(a[l].context,e,n);break;case 4:a[l].fn.call(a[l].context,e,n,r);break;default:if(!c)for(f=1,c=new Array(u-1);f<u;f++)c[f-1]=arguments[f];a[l].fn.apply(a[l].context,c)}return!0},c.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,n,r){t=h?h+t:t;if(!this._events[t])return this;if(!e)return a(this,t),this;var o=this._events[t];if(o.fn)o.fn!==e||r&&!o.once||n&&o.context!==n||a(this,t);else{for(var i=0,s=[],c=o.length;i<c;i++)(o[i].fn!==e||r&&!o[i].once||n&&o[i].context!==n)&&s.push(o[i]);s.length?this._events[t]=1===s.length?s[0]:s:a(this,t)}return this},c.prototype.removeAllListeners=function(t){return t?(t=h?h+t:t,this._events[t]&&a(this,t)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=h,c.EventEmitter=c,void 0!==e&&(e.exports=c)},{}],4:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(t,e){var n;e&&(t.super_=e,(n=function(){}).prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t)}},{}],5:[function(t,e,n){"use strict";var o=new RegExp("^((?:\\d+)?\\.?\\d+) *("+["milliseconds?","msecs?","ms","seconds?","secs?","s","minutes?","mins?","m","hours?","hrs?","h","days?","d","weeks?","wks?","w","years?","yrs?","y"].join("|")+")?$","i");e.exports=function(t){var e,n,r=typeof t;if("number"==r)return t;if("string"!=r||"0"===t||!t)return 0;if(+t)return+t;if(1e4<t.length||!(n=o.exec(t)))return 0;switch(e=parseFloat(n[1]),n[2].toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 31536e6*e;case"weeks":case"week":case"wks":case"wk":case"w":return 6048e5*e;case"days":case"day":case"d":return 864e5*e;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*e;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*e;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*e;default:return e}}},{}],6:[function(t,e,n){"use strict";e.exports=function(t){var e,n=0;function r(){return n||(n=1,e=t.apply(this,arguments),t=null),e}return r.displayName=t.displayName||t.name||r.displayName||r.name,r}},{}],7:[function(t,e,n){var r,o,e=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(t){o=s}}();var a,u=[],f=!1,p=-1;function l(){f&&a&&(f=!1,a.length?u=a.concat(u):p=-1,u.length&&h())}function h(){if(!f){var t=c(l);f=!0;for(var e=u.length;e;){for(a=u,u=[];++p<e;)a&&a[p].run();p=-1,e=u.length}a=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function d(){}e.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new y(t,e)),1!==u.length||f||c(h)},y.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=d,e.addListener=d,e.once=d,e.off=d,e.removeListener=d,e.removeAllListeners=d,e.emit=d,e.prependListener=d,e.prependOnceListener=d,e.listeners=function(t){return[]},e.binding=function(t){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(t){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],8:[function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty;function s(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function c(t){try{return encodeURIComponent(t)}catch(t){return null}}n.stringify=function(t,e){var n,r,o=[];for(r in"string"!=typeof(e=e||"")&&(e="?"),t)i.call(t,r)&&((n=t[r])||null!=n&&!isNaN(n)||(n=""),r=c(r),n=c(n),null!==r&&null!==n&&o.push(r+"="+n));return o.length?e+o.join("&"):""},n.parse=function(t){for(var e=/([^=?#&]+)=?([^&]*)/g,n={};o=e.exec(t);){var r=s(o[1]),o=s(o[2]);null===r||null===o||r in n||(n[r]=o)}return n}},{}],9:[function(t,e,n){"use strict";var r=t("eventemitter3"),o=t("millisecond"),i=t("demolish"),s=t("tick-tock"),c=t("one-time");function a(t,e,n){return o((t in n?n:t in e?e:u)[t])}function u(t){var e=this;if(!(e instanceof u))return new u(t);t=t||{},e.attempt=null,e._fn=null,e["reconnect timeout"]=a("reconnect timeout",e,t),e.retries=a("retries",e,t),e.factor=a("factor",e,t),e.max=a("max",e,t),e.min=a("min",e,t),e.timers=new s(e)}((u.prototype=new r).constructor=u)["reconnect timeout"]="30 seconds",u.max=1/0,u.min="500 ms",u.retries=10,u.factor=2,u.prototype.reconnect=function(){var n=this;return n.backoff(function(t,e){return e.duration=+new Date-e.start,t?n.emit("reconnect failed",t,e):void n.emit("reconnected",e)},n.attempt)},u.prototype.backoff=function(n,r){var o=this;return(r=r||o.attempt||{}).backoff?o:(r["reconnect timeout"]=a("reconnect timeout",o,r),r.retries=a("retries",o,r),r.factor=a("factor",o,r),r.max=a("max",o,r),r.min=a("min",o,r),r.start=+r.start||+new Date,r.duration=+r.duration||0,r.attempt=+r.attempt||0,r.attempt===r.retries?n.call(o,new Error("Unable to recover"),r):(r.backoff=!0,r.attempt++,(o.attempt=r).scheduled=1!==r.attempt?Math.min(Math.round((Math.random()+1)*r.min*Math.pow(r.factor,r.attempt-1)),r.max):r.min,o.timers.setTimeout("reconnect",function(){r.duration=+new Date-r.start,r.backoff=!1,o.timers.clear("reconnect, timeout");var e=o._fn=c(function(t){return o.reset(),t?o.backoff(n,r):void n.call(o,void 0,r)});o.emit("reconnect",r,e),o.timers.setTimeout("timeout",function(){var t=new Error("Failed to reconnect in a timely manner");r.duration=+new Date-r.start,o.emit("reconnect timeout",t,r),e(t)},r["reconnect timeout"])},r.scheduled),o.emit("reconnect scheduled",r)),o)},u.prototype.reconnecting=function(){return!!this.attempt},u.prototype.reconnected=function(t){return this._fn&&this._fn(t),this},u.prototype.reset=function(){return this._fn=this.attempt=null,this.timers.clear("reconnect, timeout"),this},u.prototype.destroy=i("timers attempt _fn"),e.exports=u},{demolish:1,eventemitter3:10,millisecond:5,"one-time":6,"tick-tock":12}],10:[function(t,e,n){"use strict";var h="function"!=typeof Object.create&&"~";function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(){}o.prototype._events=void 0,o.prototype.listeners=function(t,e){var n=this._events&&this._events[h?h+t:t];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,i=new Array(o);r<o;r++)i[r]=n[r].fn;return i},o.prototype.emit=function(t,e,n,r,o,i){var s=h?h+t:t;if(!this._events||!this._events[s])return!1;var c,a=this._events[s],u=arguments.length;if("function"==typeof a.fn){switch(a.once&&this.removeListener(t,a.fn,void 0,!0),u){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,e),!0;case 3:return a.fn.call(a.context,e,n),!0;case 4:return a.fn.call(a.context,e,n,r),!0;case 5:return a.fn.call(a.context,e,n,r,o),!0;case 6:return a.fn.call(a.context,e,n,r,o,i),!0}for(l=1,c=new Array(u-1);l<u;l++)c[l-1]=arguments[l];a.fn.apply(a.context,c)}else for(var f,p=a.length,l=0;l<p;l++)switch(a[l].once&&this.removeListener(t,a[l].fn,void 0,!0),u){case 1:a[l].fn.call(a[l].context);break;case 2:a[l].fn.call(a[l].context,e);break;case 3:a[l].fn.call(a[l].context,e,n);break;default:if(!c)for(f=1,c=new Array(u-1);f<u;f++)c[f-1]=arguments[f];a[l].fn.apply(a[l].context,c)}return!0},o.prototype.on=function(t,e,n){n=new r(e,n||this),t=h?h+t:t;return this._events||(this._events=h?{}:Object.create(null)),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],n]:this._events[t].push(n):this._events[t]=n,this},o.prototype.once=function(t,e,n){n=new r(e,n||this,!0),t=h?h+t:t;return this._events||(this._events=h?{}:Object.create(null)),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],n]:this._events[t].push(n):this._events[t]=n,this},o.prototype.removeListener=function(t,e,n,r){t=h?h+t:t;if(!this._events||!this._events[t])return this;var o=this._events[t],i=[];if(e)if(o.fn)(o.fn!==e||r&&!o.once||n&&o.context!==n)&&i.push(o);else for(var s=0,c=o.length;s<c;s++)(o[s].fn!==e||r&&!o[s].once||n&&o[s].context!==n)&&i.push(o[s]);return i.length?this._events[t]=1===i.length?i[0]:i:delete this._events[t],this},o.prototype.removeAllListeners=function(t){return this._events&&(t?delete this._events[h?h+t:t]:this._events=h?{}:Object.create(null)),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prototype.setMaxListeners=function(){return this},o.prefixed=h,void 0!==e&&(e.exports=o)},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}},{}],12:[function(t,f,e){!function(o,n){!function(){"use strict";var i=Object.prototype.hasOwnProperty,s=t("millisecond");function c(t,e,n,r){this.start=+new Date,this.duration=n,this.clear=e,this.timer=t,this.fns=[r]}function a(t){clearTimeout(t)}function u(t){clearInterval(t)}function r(t){n(t)}function e(t){if(!(this instanceof e))return new e(t);this.timers={},this.context=t||this}c.prototype.remaining=function(){return this.duration-this.taken()},c.prototype.taken=function(){return+new Date-this.start},e.prototype.tock=function(r,o){var i=this;return function(){if(r in i.timers){var t=i.timers[r].fns.slice(),e=t.length,n=0;for(o?i.clear(r):i.start=+new Date;n<e;n++)t[n].call(i.context)}}},e.prototype.setTimeout=function(t,e,n){var r,o=this;return o.timers[t]?o.timers[t].fns.push(e):(r=s(n),o.timers[t]=new c(setTimeout(o.tock(t,!0),s(n)),a,r,e)),o},e.prototype.setInterval=function(t,e,n){var r,o=this;return o.timers[t]?o.timers[t].fns.push(e):(r=s(n),o.timers[t]=new c(setInterval(o.tock(t),s(n)),u,r,e)),o},e.prototype.setImmediate=function(t,e){var n=this;return"function"!=typeof o?n.setTimeout(t,e,0):(n.timers[t]?n.timers[t].fns.push(e):n.timers[t]=new c(o(n.tock(t,!0)),r,0,e),n)},e.prototype.active=function(t){return t in this.timers},e.prototype.clear=function(){var t,e,n,r=arguments.length?arguments:[],o=this;if(!(r=1===r.length&&"string"==typeof r[0]?r[0].split(/[, ]+/):r).length)for(t in o.timers)i.call(o.timers,t)&&r.push(t);for(e=0,n=r.length;e<n;e++)(t=o.timers[r[e]])&&(t.clear(t.timer),t.fns=t.timer=t.clear=null,delete o.timers[r[e]]);return o},e.prototype.adjust=function(t,e){var n=s(e),r=this.timers[t];return r&&(e=r.clear===u,r.clear(r.timer),r.start=+new Date,r.duration=n,r.timer=(e?setInterval:setTimeout)(this.tock(t,!e),n)),this},e.prototype.end=e.prototype.destroy=function(){return!!this.context&&(this.clear(),!(this.context=this.timers=null))},e.Timer=c,f.exports=e}.call(this)}.call(this,t("timers").setImmediate,t("timers").clearImmediate)},{millisecond:5,timers:13}],13:[function(a,t,u){!function(n,c){!function(){var r=a("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,i={},s=0;function e(t,e){this._id=t,this._clearFn=e}u.setTimeout=function(){return new e(t.call(setTimeout,window,arguments),clearTimeout)},u.setInterval=function(){return new e(t.call(setInterval,window,arguments),clearInterval)},u.clearTimeout=u.clearInterval=function(t){t.close()},e.prototype.unref=e.prototype.ref=function(){},e.prototype.close=function(){this._clearFn.call(window,this._id)},u.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},u.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},u._unrefActive=u.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},u.setImmediate="function"==typeof n?n:function(t){var e=s++,n=!(arguments.length<2)&&o.call(arguments,1);return i[e]=!0,r(function(){i[e]&&(n?t.apply(null,n):t.call(null),u.clearImmediate(e))}),e},u.clearImmediate="function"==typeof c?c:function(t){delete i[t]}}.call(this)}.call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":7,timers:13}],14:[function(t,n,e){!function(s){!function(){"use strict";var l=t("requires-port"),h=t("querystringify"),o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,y=/^[a-zA-Z]:/,e=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function d(t){return(t||"").toString().replace(e,"")}var m=[["#","hash"],["?","query"],function(t,e){return g(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],i={hash:1,query:1};function v(t){var e,n="undefined"!=typeof window?window:void 0!==s?s:"undefined"!=typeof self?self:{},n=n.location||{},r={},n=typeof(t=t||n);if("blob:"===t.protocol)r=new w(unescape(t.pathname),{});else if("string"==n)for(e in r=new w(t,{}),i)delete r[e];else if("object"==n){for(e in t)e in i||(r[e]=t[e]);void 0===r.slashes&&(r.slashes=o.test(t.href))}return r}function g(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function b(t,e){t=d(t),e=e||{};var n,r=c.exec(t),o=r[1]?r[1].toLowerCase():"",i=!!r[2],s=!!r[3],t=0;return i?t=s?(n=r[2]+r[3]+r[4],r[2].length+r[3].length):(n=r[2]+r[4],r[2].length):s?(n=r[3]+r[4],t=r[3].length):n=r[4],"file:"===o?2<=t&&(n=n.slice(2)):g(o)?n=r[4]:o?i&&(n=n.slice(2)):2<=t&&g(e.protocol)&&(n=r[4]),{protocol:o,slashes:i||g(o),slashesCount:t,rest:n}}function w(t,e,n){if(t=d(t),!(this instanceof w))return new w(t,e,n);var r,o,i,s,c,a=m.slice(),u=typeof e,f=this,p=0;for("object"!=u&&"string"!=u&&(n=e,e=null),n&&"function"!=typeof n&&(n=h.parse),r=!(u=b(t||"",e=v(e))).protocol&&!u.slashes,f.slashes=u.slashes||r&&e.slashes,f.protocol=u.protocol||e.protocol||"",t=u.rest,("file:"===u.protocol&&(2!==u.slashesCount||y.test(t))||!u.slashes&&(u.protocol||u.slashesCount<2||!g(f.protocol)))&&(a[3]=[/(.*)/,"pathname"]);p<a.length;p++)"function"!=typeof(i=a[p])?(o=i[0],c=i[1],o!=o?f[c]=t:"string"==typeof o?~(s=t.indexOf(o))&&(t="number"==typeof i[2]?(f[c]=t.slice(0,s),t.slice(s+i[2])):(f[c]=t.slice(s),t.slice(0,s))):(s=o.exec(t))&&(f[c]=s[1],t=t.slice(0,s.index)),f[c]=f[c]||r&&i[3]&&e[c]||"",i[4]&&(f[c]=f[c].toLowerCase())):t=i(t,f);n&&(f.query=n(f.query)),r&&e.slashes&&"/"!==f.pathname.charAt(0)&&(""!==f.pathname||""!==e.pathname)&&(f.pathname=function(t,e){if(""===t)return e;for(var n=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=n.length,t=n[r-1],o=!1,i=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),i++):i&&(0===r&&(o=!0),n.splice(r,1),i--);return o&&n.unshift(""),"."!==t&&".."!==t||n.push(""),n.join("/")}(f.pathname,e.pathname)),"/"!==f.pathname.charAt(0)&&g(f.protocol)&&(f.pathname="/"+f.pathname),l(f.port,f.protocol)||(f.host=f.hostname,f.port=""),f.username=f.password="",f.auth&&(i=f.auth.split(":"),f.username=i[0]||"",f.password=i[1]||""),f.origin="file:"!==f.protocol&&g(f.protocol)&&f.host?f.protocol+"//"+f.host:"null",f.href=f.toString()}w.prototype={set:function(t,e,n){var r,o=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(n||h.parse)(e)),o[t]=e;break;case"port":o[t]=e,l(e,o.protocol)?e&&(o.host=o.hostname+":"+e):(o.host=o.hostname,o[t]="");break;case"hostname":o[t]=e,o.port&&(e+=":"+o.port),o.host=e;break;case"host":o[t]=e,/:\d+$/.test(e)?(e=e.split(":"),o.port=e.pop(),o.hostname=e.join(":")):(o.hostname=e,o.port="");break;case"protocol":o.protocol=e.toLowerCase(),o.slashes=!n;break;case"pathname":case"hash":e?(r="pathname"===t?"/":"#",o[t]=e.charAt(0)!==r?r+e:e):o[t]=e;break;default:o[t]=e}for(var i=0;i<m.length;i++){var s=m[i];s[4]&&(o[s[1]]=o[s[1]].toLowerCase())}return o.origin="file:"!==o.protocol&&g(o.protocol)&&o.host?o.protocol+"//"+o.host:"null",o.href=o.toString(),o},toString:function(t){t&&"function"==typeof t||(t=h.stringify);var e=this,n=e.protocol;return n&&":"!==n.charAt(n.length-1)&&(n+=":"),n+=e.slashes||g(e.protocol)?"//":"",e.username&&(n+=e.username,e.password&&(n+=":"+e.password),n+="@"),n+=e.host+e.pathname,(t="object"==typeof e.query?t(e.query):e.query)&&(n+="?"!==t.charAt(0)?"?"+t:t),e.hash&&(n+=e.hash),n}},w.extractProtocol=b,w.location=v,w.trimLeft=d,w.qs=h,n.exports=w}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{querystringify:8,"requires-port":11}],15:[function(t,e,n){"use strict";var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i=64,s={},c=0,a=0;function u(t){for(var e="";e=o[t%i]+e,0<(t=Math.floor(t/i)););return e}function f(){var t=u(+new Date);return t!==r?(c=0,r=t):t+"."+u(c++)}for(;a<i;a++)s[o[a]]=a;f.encode=u,f.decode=function(t){var e=0;for(a=0;a<t.length;a++)e=e*i+s[t.charAt(a)];return e},e.exports=f},{}],16:[function(e,t,n){"use strict";var r,o=e("eventemitter3"),i=e("tick-tock"),s=e("recovery"),c=e("querystringify"),a=e("inherits"),u=e("demolish"),f=e("yeast"),p=/\u2028/g,l=/\u2029/g;function h(t,e){if(!(t instanceof y)){e=new Error("Primus#"+e+"'s context should called with a Primus instance");if("function"!=typeof t.listeners||!t.listeners("error").length)throw e;t.emit("error",e)}}try{r=location.origin||location.protocol+"//"+location.host}catch(t){r="http://127.0.0.1"}function y(t,e){if(!(this instanceof y))return new y(t,e);if(y.Stream.call(this),"function"!=typeof this.client)return this.critical(new Error("The client library has not been compiled correctly, see https://github.com/primus/primus#client-library for more details"));if("object"==typeof t?t=(e=t).url||e.uri||r:e=e||{},"ping"in e||"pong"in e)return this.critical(new Error("The `ping` and `pong` options have been removed"));var n=this;e.queueSize="queueSize"in e?e.queueSize:1/0,e.timeout="timeout"in e?e.timeout:1e4,e.reconnect="reconnect"in e?e.reconnect:{},e.pingTimeout="pingTimeout"in e?e.pingTimeout:45e3,e.strategy="strategy"in e?e.strategy:[],e.transport="transport"in e?e.transport:{},n.buffer=[],n.writable=!0,n.readable=!0,n.url=n.parse(t||r),n.readyState=y.CLOSED,n.options=e,n.timers=new i(this),n.socket=null,n.disconnect=!1,n.transport=e.transport,n.transformers={outgoing:[],incoming:[]},n.recovery=new s(e.reconnect),"string"==typeof e.strategy&&(e.strategy=e.strategy.split(/\s?,\s?/g)),!1===e.strategy?e.strategy=[]:e.strategy.length||(e.strategy.push("disconnect","online"),this.authorization||e.strategy.push("timeout")),e.strategy=e.strategy.join(",").toLowerCase(),"websockets"in e&&(n.AVOID_WEBSOCKETS=!e.websockets),"network"in e&&(n.NETWORK_EVENTS=e.network),e.manual||n.timers.setTimeout("open",function(){n.timers.clear("open"),n.open()},0),n.initialise(e)}y.requires=y.require=function(t){if("function"==typeof e)return e(t)};try{y.Stream=y.requires("stream")}catch(t){}y.Stream||(y.Stream=o),a(y,y.Stream),y.OPENING=1,y.CLOSED=2,y.OPEN=3,y.prototype.AVOID_WEBSOCKETS=!1,y.prototype.NETWORK_EVENTS=!1,y.prototype.online=!0;try{(y.prototype.NETWORK_EVENTS="onLine"in navigator&&(window.addEventListener||document.body.attachEvent))&&(navigator.onLine||(y.prototype.online=!1))}catch(t){}y.prototype.ark={},y.prototype.emits=e("emits"),y.prototype.plugin=function(t){if(h(this,"plugin"),t)return this.ark[t];var e={};for(t in this.ark)e[t]=this.ark[t];return e},(y.prototype.reserved=function(t){return/^(incoming|outgoing)::/.test(t)||t in this.reserved.events}).events={"reconnect scheduled":1,"reconnect timeout":1,readyStateChange:1,"reconnect failed":1,reconnected:1,reconnect:1,offline:1,timeout:1,destroy:1,online:1,error:1,close:1,open:1,data:1,end:1},y.prototype.initialise=function(t){var e,o=this;for(e in o.recovery.on("reconnected",o.emits("reconnected")).on("reconnect failed",o.emits("reconnect failed",function(t){o.emit("end"),t()})).on("reconnect timeout",o.emits("reconnect timeout")).on("reconnect scheduled",o.emits("reconnect scheduled")).on("reconnect",o.emits("reconnect",function(t){o.emit("outgoing::reconnect"),t()})),o.on("outgoing::open",function(){var t=o.readyState;o.readyState=y.OPENING,t!==o.readyState&&o.emit("readyStateChange","opening")}),o.on("incoming::open",function(){var t=o.readyState;if(o.recovery.reconnecting()&&o.recovery.reconnected(),o.writable=!0,o.readable=!0,o.online||(o.online=!0,o.emit("online")),o.readyState=y.OPEN,t!==o.readyState&&o.emit("readyStateChange","open"),o.heartbeat(),o.buffer.length){var e=o.buffer.slice(),n=e.length,r=0;for(o.buffer.length=0;r<n;r++)o._write(e[r])}o.emit("open")}),o.on("incoming::ping",function(t){o.online=!0,o.heartbeat(),o.emit("outgoing::pong",t),o._write("primus::pong::"+t)}),o.on("incoming::error",function(t){var e=o.timers.active("connect"),n=t;if("string"==typeof t)n=new Error(t);else if(!(t instanceof Error)&&"object"==typeof t)for(var r in n=new Error(t.message||t.reason),t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);if(o.recovery.reconnecting())return o.recovery.reconnected(n);o.listeners("error").length&&o.emit("error",n),e&&(~o.options.strategy.indexOf("timeout")?o.recovery.reconnect():o.end())}),o.on("incoming::data",function(n){o.decoder(n,function(t,e){return t?o.listeners("error").length&&o.emit("error",t):void(o.protocol(e)||o.transforms(o,o,"incoming",e,n))})}),o.on("incoming::end",function(){var t=o.readyState;return o.disconnect?(o.disconnect=!1,o.end()):(o.readyState=y.CLOSED,t!==o.readyState&&o.emit("readyStateChange","end"),o.timers.active("connect")&&o.end(),t!==y.OPEN?!!o.recovery.reconnecting()&&o.recovery.reconnect():(this.writable=!1,this.readable=!1,this.timers.clear(),o.emit("close"),~o.options.strategy.indexOf("disconnect")?o.recovery.reconnect():(o.emit("outgoing::end"),void o.emit("end"))))}),o.client(),o.ark)o.ark[e].call(o,o,t);return o.NETWORK_EVENTS&&(o.offlineHandler=function(){o.online&&(o.online=!1,o.emit("offline"),o.end(),o.recovery.reset())},o.onlineHandler=function(){o.online||(o.online=!0,o.emit("online"),~o.options.strategy.indexOf("online")&&o.recovery.reconnect())},window.addEventListener?(window.addEventListener("offline",o.offlineHandler,!1),window.addEventListener("online",o.onlineHandler,!1)):document.body.attachEvent&&(document.body.attachEvent("onoffline",o.offlineHandler),document.body.attachEvent("ononline",o.onlineHandler))),o},y.prototype.protocol=function(t){if("string"!=typeof t||0!==t.indexOf("primus::"))return!1;var e=t.indexOf(":",8),n=t.slice(e+2);switch(t.slice(8,e)){case"ping":this.emit("incoming::ping",+n);break;case"server":"close"===n&&(this.disconnect=!0);break;case"id":this.emit("incoming::id",n);break;default:return!1}return!0},y.prototype.transforms=function(t,i,e,n,r){var s={data:n},c=t.transformers[e];return function n(r,o){var t=c[r++];return t?1===t.length?!1===t.call(i,s)?void 0:n(r,o):void t.call(i,s,function(t,e){return t?i.emit("error",t):void(!1!==e&&n(r,o))}):o()}(0,function(){return"incoming"===e?i.emit("data",s.data,r):void i._write(s.data)}),this},y.prototype.id=function(t){return this.socket&&this.socket.id?t(this.socket.id):(this._write("primus::id::"),this.once("incoming::id",t))},y.prototype.open=function(){return h(this,"open"),!this.recovery.reconnecting()&&this.options.timeout&&this.timeout(),this.emit("outgoing::open"),this},y.prototype.write=function(t){return h(this,"write"),this.transforms(this,this,"outgoing",t),!0},y.prototype._write=function(t){var n=this;return y.OPEN!==n.readyState?(this.buffer.length===this.options.queueSize&&this.buffer.splice(0,1),this.buffer.push(t),!1):(n.encoder(t,function(t,e){return t?n.listeners("error").length&&n.emit("error",t):("string"==typeof e&&~(e=~e.indexOf("\u2028")?e.replace(p,"\\u2028"):e).indexOf("\u2029")&&(e=e.replace(l,"\\u2029")),void n.emit("outgoing::data",e))}),!0)},y.prototype.heartbeat=function(){return this.options.pingTimeout&&(this.timers.clear("heartbeat"),this.timers.setTimeout("heartbeat",function(){this.online&&(this.online=!1,this.emit("offline"),this.emit("incoming::end"))},this.options.pingTimeout)),this},y.prototype.timeout=function(){var t=this;function e(){t.removeListener("error",e).removeListener("open",e).removeListener("end",e).timers.clear("connect")}return t.timers.setTimeout("connect",function(){e(),t.readyState===y.OPEN||t.recovery.reconnecting()||(t.emit("timeout"),~t.options.strategy.indexOf("timeout")?t.recovery.reconnect():t.end())},t.options.timeout),t.on("error",e).on("open",e).on("end",e)},y.prototype.end=function(t){if(h(this,"end"),this.readyState===y.CLOSED&&!this.timers.active("connect")&&!this.timers.active("open"))return this.recovery.reconnecting()&&(this.recovery.reset(),this.emit("end")),this;void 0!==t&&this.write(t),this.writable=!1,this.readable=!1;t=this.readyState;return this.readyState=y.CLOSED,t!==this.readyState&&this.emit("readyStateChange","end"),this.timers.clear(),this.emit("outgoing::end"),this.emit("close"),this.emit("end"),this},y.prototype.destroy=u("url timers options recovery socket transport transformers",{before:"end",after:["removeAllListeners",function(){this.NETWORK_EVENTS&&(window.addEventListener?(window.removeEventListener("offline",this.offlineHandler),window.removeEventListener("online",this.onlineHandler)):document.body.attachEvent&&(document.body.detachEvent("onoffline",this.offlineHandler),document.body.detachEvent("ononline",this.onlineHandler)))}]}),y.prototype.clone=function(t){return this.merge({},t)},y.prototype.merge=function(t){for(var e,n,r=1;r<arguments.length;r++)for(e in n=arguments[r])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t},y.prototype.parse=e("url-parse"),y.prototype.querystring=c.parse,y.prototype.querystringify=c.stringify,y.prototype.uri=function(t){var e=this.url,n=[],r=!1;t.query&&(r=!0),(t=t||{}).protocol="protocol"in t?t.protocol:"http:",t.query=!(!e.query||!r)&&e.query.slice(1),t.secure="secure"in t?t.secure:"https:"===e.protocol||"wss:"===e.protocol,t.auth=("auth"in t?t:e).auth,t.pathname=("pathname"in t?t:this).pathname,t.port="port"in t?+t.port:+e.port||(t.secure?443:80);var o=this.querystring(t.query||"");return o._primuscb=f(),t.query=this.querystringify(o),this.emit("outgoing::url",t),n.push(t.secure?t.protocol.replace(":","s:"):t.protocol,""),n.push(t.auth?t.auth+"@"+e.host:e.host),t.pathname&&n.push(t.pathname.slice(1)),r?n[n.length-1]+="?"+t.query:delete t.query,t.object?t:n.join("/")},y.prototype.transform=function(t,e){return h(this,"transform"),t in this.transformers?(this.transformers[t].push(e),this):this.critical(new Error("Invalid transformer type"))},y.prototype.critical=function(t){if(this.emit("error",t))return this;throw t},y.connect=function(t,e){return new y(t,e)},y.EventEmitter=o,y.prototype.client=function(){var e,t=this.emits("incoming::data"),n=this.emits("incoming::error"),r=this.emits("incoming::open"),o=this.emits("incoming::end"),i=this,s=function(){if("undefined"!=typeof eio)return eio;try{return y.requires("engine.io-client")}catch(t){}}();if(!s)return i.critical(new Error("Missing required `engine.io-client` module. Please run `npm install --save engine.io-client`"));i.on("outgoing::open",function(){i.emit("outgoing::end"),i.socket=e=s(i.merge(i.transport,i.url,i.uri({protocol:"http:",query:!0,object:!0}),{rememberUpgrade:!1,forceBase64:!0,enablesXDR:!1,timestampRequests:!0,path:this.pathname,transports:i.AVOID_WEBSOCKETS?["polling"]:["polling","websocket"]})),s.sockets&&s.sockets.length&&(s.sockets.length=0),e.on("message",t),e.on("error",n),e.on("close",o),e.on("open",r)}),i.on("outgoing::data",function(t){e&&e.send(t)}),i.on("outgoing::reconnect",function(){i.emit("outgoing::open")}),i.on("outgoing::end",function(){e&&(e.removeListener("message",t),e.removeListener("error",n),e.removeListener("close",o),e.removeListener("open",r),e.close(),e=null)})},y.prototype.authorization=!1,y.prototype.pathname="/connectPrimus",y.prototype.encoder=function(t,e){var n;try{t=JSON.stringify(t)}catch(t){n=t}e(n,t)},y.prototype.decoder=function(t,e){var n;if("string"!=typeof t)return e(n,t);try{t=JSON.parse(t)}catch(t){n=t}e(n,t)},y.prototype.version="8.0.5","undefined"!=typeof document&&"undefined"!=typeof navigator&&(document.addEventListener&&document.addEventListener("keydown",function(t){27===t.keyCode&&t.preventDefault&&t.preventDefault()},!1),o=+[(o=(c=(navigator.userAgent||"").toLowerCase()).match(/.+(?:rv|it|ra|ie)[/: ](\d+)\.(\d+)(?:\.(\d+))?/)||[])[1],o[2]].join("."),!~c.indexOf("chrome")&&~c.indexOf("safari")&&o<534.54&&(y.prototype.AVOID_WEBSOCKETS=!0)),t.exports=y},{demolish:1,emits:2,eventemitter3:3,inherits:4,querystringify:8,recovery:9,"tick-tock":12,"url-parse":14,yeast:15}]},{},[16])(16)},[function(t){var e;"undefined"!=typeof window?e=window:"undefined"!=typeof self&&(e=self),e.eio=function r(o,i,s){function c(e,t){if(!i[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(a)return a(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=i[e]={exports:{}},o[e][0].call(n.exports,function(t){return c(o[e][1][t]||t)},n,n.exports,r,o,i,s)}return i[e].exports}for(var a="function"==typeof require&&require,t=0;t<s.length;t++)c(s[t]);return c}({1:[function(t,e,n){},{}],2:[function(t,e,n){"use strict";e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},{}],3:[function(t,e,n){"use strict";function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=u(n);return t=r?(t=u(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==i(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=t("./transports/index"),l=t("component-emitter"),h=t("engine.io-parser"),y=t("parseuri"),d=t("parseqs"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,l);var t,e,n,r=a(p);function p(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),e=r.call(this),t&&"object"===i(t)&&(n=t,t=null),t?(t=y(t),n.hostname=t.host,n.secure="https"===t.protocol||"wss"===t.protocol,n.port=t.port,t.query&&(n.query=t.query)):n.host&&(n.hostname=y(n.host).host),e.secure=null!=n.secure?n.secure:"undefined"!=typeof location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=e.secure?"443":"80"),e.hostname=n.hostname||("undefined"!=typeof location?location.hostname:"localhost"),e.port=n.port||("undefined"!=typeof location&&location.port?location.port:e.secure?443:80),e.transports=n.transports||["polling","websocket"],e.readyState="",e.writeBuffer=[],e.prevBufferLen=0,e.opts=o({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},n),e.opts.path=e.opts.path.replace(/\/$/,"")+"/","string"==typeof e.opts.query&&(e.opts.query=d.decode(e.opts.query)),e.id=null,e.upgrades=null,e.pingInterval=null,e.pingTimeout=null,e.pingTimeoutTimer=null,"function"==typeof addEventListener&&(e.opts.closeOnBeforeunload&&addEventListener("beforeunload",function(){e.transport&&(e.transport.removeAllListeners(),e.transport.close())},!1),"localhost"!==e.hostname&&(e.offlineEventListener=function(){e.onClose("transport close")},addEventListener("offline",e.offlineEventListener,!1))),e.open(),e}return t=p,(e=[{key:"createTransport",value:function(t){var e=function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(this.opts.query);e.EIO=h.protocol,e.transport=t,this.id&&(e.sid=this.id);e=o({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new f[t](e)}},{key:"open",value:function(){var t,e=this;if(this.opts.rememberUpgrade&&p.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void setTimeout(function(){e.emit("error","No transports available")},0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}},{key:"setTransport",value:function(t){var e=this;this.transport&&this.transport.removeAllListeners(),(this.transport=t).on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",function(){e.onClose("transport close")})}},{key:"probe",value:function(t){var e=this,n=this.createTransport(t,{probe:1}),r=!1;p.priorWebsocketSuccess=!1;var o=function(){r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",function(t){r||("pong"===t.type&&"probe"===t.data?(e.upgrading=!0,e.emit("upgrading",n),n&&(p.priorWebsocketSuccess="websocket"===n.name,e.transport.pause(function(){r||"closed"!==e.readyState&&(f(),e.setTransport(n),n.send([{type:"upgrade"}]),e.emit("upgrade",n),n=null,e.upgrading=!1,e.flush())}))):((t=new Error("probe error")).transport=n.name,e.emit("upgradeError",t)))}))};function i(){r||(r=!0,f(),n.close(),n=null)}var s=function(t){t=new Error("probe error: "+t);t.transport=n.name,i(),e.emit("upgradeError",t)};function c(){s("transport closed")}function a(){s("socket closed")}function u(t){n&&t.name!==n.name&&i()}var f=function(){n.removeListener("open",o),n.removeListener("error",s),n.removeListener("close",c),e.removeListener("close",a),e.removeListener("upgrading",u)};n.once("open",o),n.once("error",s),n.once("close",c),this.once("close",a),this.once("upgrading",u),n.open()}},{key:"onOpen",value:function(){if(this.readyState="open",p.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},{key:"onPacket",value:function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("ping"),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}}},{key:"onHandshake",value:function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var t=this;clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(function(){t.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)===this.writeBuffer.length?this.emit("drain"):this.flush()}},{key:"flush",value:function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}},{key:"write",value:function(t,e,n){return this.sendPacket("message",t,e,n),this}},{key:"send",value:function(t,e,n){return this.sendPacket("message",t,e,n),this}},{key:"sendPacket",value:function(t,e,n,r){"function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState&&((n=n||{}).compress=!1!==n.compress,this.emit("packetCreate",n={type:t,data:e,options:n}),this.writeBuffer.push(n),r&&this.once("flush",r),this.flush())}},{key:"close",value:function(){function t(){n.removeListener("upgrade",t),n.removeListener("upgradeError",t),r()}function e(){n.once("upgrade",t),n.once("upgradeError",t)}var n=this,r=function(){n.onClose("forced close"),n.transport.close()};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){(n.upgrading?e:r)()}):(this.upgrading?e:r)()),this}},{key:"onError",value:function(t){p.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)}},{key:"onClose",value:function(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}])&&s(t.prototype,e),n&&s(t,n),p}();t.priorWebsocketSuccess=!1,t.protocol=h.protocol,e.exports=t},{"./transports/index":5,"component-emitter":14,"engine.io-parser":18,parseqs:20,parseuri:21}],4:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=a(n);return t=r?(t=a(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=t("engine.io-parser"),f=t("component-emitter"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(o,f);var t,e,n,r=c(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).opts=t,e.query=t.query,e.readyState="",e.socket=t.socket,e}return t=o,(e=[{key:"onError",value:function(t,e){t=new Error(t);return t.type="TransportError",t.description=e,this.emit("error",t),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(t){"open"===this.readyState&&this.write(t)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,this.emit("open")}},{key:"onData",value:function(t){t=u.decodePacket(t,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(t){this.emit("packet",t)}},{key:"onClose",value:function(){this.readyState="closed",this.emit("close")}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"component-emitter":14,"engine.io-parser":18}],5:[function(t,e,n){"use strict";var s=t("../../contrib/xmlhttprequest-ssl/XMLHttpRequest"),c=t("./polling-xhr"),a=t("./polling-jsonp"),t=t("./websocket");n.polling=function(t){var e=!1,n=!1,r=!1!==t.jsonp;{var o,i;"undefined"!=typeof location&&(o="https:"===location.protocol,i=(i=location.port)||(o?443:80),e=t.hostname!==location.hostname||i!==t.port,n=t.secure!==o)}{if(t.xdomain=e,t.xscheme=n,"open"in new s(t)&&!t.forceJSONP)return new c(t);if(!r)throw new Error("JSONP disabled");return new a(t)}},n.websocket=t},{"../../contrib/xmlhttprequest-ssl/XMLHttpRequest":12,"./polling-jsonp":6,"./polling-xhr":7,"./websocket":10}],6:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=f(n);return t=r?(t=f(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?u(e):t}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p,l=t("./polling"),h=t("../globalThis"),y=/\n/g,d=/\\n/g,t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(o,l);var t,e,n,r=a(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,t)).query=t.query||{},p=p||(h.___eio=h.___eio||[]),t.index=p.length,p.push(t.onData.bind(u(t))),t.query.j=t.index,t}return t=o,(e=[{key:"supportsBinary",get:function(){return!1}},{key:"doClose",value:function(){this.script&&(this.script.onerror=function(){},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),s(f(o.prototype),"doClose",this).call(this)}},{key:"doPoll",value:function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)}},{key:"doWrite",value:function(t,e){var n,r,o,i,s=this;function c(){a(),e()}this.form||(r=document.createElement("form"),o=document.createElement("textarea"),i=this.iframeId="eio_iframe_"+this.index,r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=i,r.method="POST",r.setAttribute("accept-charset","utf-8"),o.name="d",r.appendChild(o),document.body.appendChild(r),this.form=r,this.area=o),this.form.action=this.uri();var a=function(){if(s.iframe)try{s.form.removeChild(s.iframe)}catch(t){s.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+s.iframeId+'">';n=document.createElement(t)}catch(t){(n=document.createElement("iframe")).name=s.iframeId,n.src="javascript:0"}n.id=s.iframeId,s.form.appendChild(n),s.iframe=n};a(),t=t.replace(d,"\\\n"),this.area.value=t.replace(y,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===s.iframe.readyState&&c()}:this.iframe.onload=c}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../globalThis":2,"./polling":8}],7:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=p(n);return t=r?(t=p(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=t("../../contrib/xmlhttprequest-ssl/XMLHttpRequest"),h=t("./polling"),y=t("component-emitter"),d=t("../util").pick,m=t("../globalThis");function v(){}var g=null!=new l({xdomain:!1}).responseType,t=function(){a(i,h);var o=f(i);function i(t){var e,n,r;s(this,i),e=o.call(this,t),"undefined"!=typeof location&&(n="https:"===location.protocol,r=(r=location.port)||(n?443:80),e.xd="undefined"!=typeof location&&t.hostname!==location.hostname||r!==t.port,e.xs=t.secure!==n);t=t&&t.forceBase64;return e.supportsBinary=g&&!t,e}return c(i,[{key:"request",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return r(t,{xd:this.xd,xs:this.xs},this.opts),new b(this.uri(),t)}},{key:"doWrite",value:function(t,e){var n=this,t=this.request({method:"POST",data:t});t.on("success",e),t.on("error",function(t){n.onError("xhr post error",t)})}},{key:"doPoll",value:function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t}}]),i}(),b=function(){a(o,y);var r=f(o);function o(t,e){var n;return s(this,o),(n=r.call(this)).opts=e,n.method=e.method||"GET",n.uri=t,n.async=!1!==e.async,n.data=void 0!==e.data?e.data:null,n.create(),n}return c(o,[{key:"create",value:function(){var e=this,t=d(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;var n=this.xhr=new l(t);try{n.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var r in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this.opts.extraHeaders[r])}catch(t){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{n.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),this.hasXDR()?(n.onload=function(){e.onLoad()},n.onerror=function(){e.onError(n.responseText)}):n.onreadystatechange=function(){4===n.readyState&&(200===n.status||1223===n.status?e.onLoad():setTimeout(function(){e.onError("number"==typeof n.status?n.status:0)},0))},n.send(this.data)}catch(t){return void setTimeout(function(){e.onError(t)},0)}"undefined"!=typeof document&&(this.index=o.requestsCount++,o.requests[this.index]=this)}},{key:"onSuccess",value:function(){this.emit("success"),this.cleanup()}},{key:"onData",value:function(t){this.emit("data",t),this.onSuccess()}},{key:"onError",value:function(t){this.emit("error",t),this.cleanup(!0)}},{key:"cleanup",value:function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=v:this.xhr.onreadystatechange=v,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete o.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var t=this.xhr.responseText;null!==t&&this.onData(t)}},{key:"hasXDR",value:function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}},{key:"abort",value:function(){this.cleanup()}}]),o}();function w(){for(var t in b.requests)b.requests.hasOwnProperty(t)&&b.requests[t].abort()}b.requestsCount=0,b.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",w):"function"==typeof addEventListener&&(m="onpagehide"in m?"pagehide":"unload",addEventListener(m,w,!1))),e.exports=t,e.exports.Request=b},{"../../contrib/xmlhttprequest-ssl/XMLHttpRequest":12,"../globalThis":2,"../util":11,"./polling":8,"component-emitter":14}],8:[function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=a(n);return t=r?(t=a(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=t("../transport"),f=t("parseqs"),p=t("engine.io-parser"),l=t("yeast"),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(o,u);var t,e,n,r=c(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.apply(this,arguments)}return t=o,(e=[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(t){var e=this;this.readyState="pausing";function n(){e.readyState="paused",t()}var r;this.polling||!this.writable?(r=0,this.polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))):n()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emit("poll")}},{key:"onData",value:function(t){var e=this;p.decodePayload(t,this.socket.binaryType).forEach(function(t){if("opening"===e.readyState&&"open"===t.type&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){function t(){e.write([{type:"close"}])}var e=this;"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(t){var e=this;this.writable=!1,p.encodePayload(t,function(t){e.doWrite(t,function(){e.writable=!0,e.emit("drain")})})}},{key:"uri",value:function(){var t=this.query||{},e=this.opts.secure?"https":"http",n="";return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=l()),this.supportsBinary||t.sid||(t.b64=1),t=f.encode(t),this.opts.port&&("https"==e&&443!==Number(this.opts.port)||"http"==e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),t.length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t}}])&&i(t.prototype,e),n&&i(t,n),o}();e.exports=t},{"../transport":4,"engine.io-parser":18,parseqs:20,yeast:22}],9:[function(t,e,n){"use strict";var r=t("../globalThis"),t="function"==typeof Promise&&"function"==typeof Promise.resolve?function(t){return Promise.resolve().then(t)}:function(t){return setTimeout(t,0)};e.exports={WebSocket:r.WebSocket||r.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer",nextTick:t}},{"../globalThis":2}],10:[function(e,n,t){!function(b){!function(){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=a(n);return t=r?(t=a(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==o(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=e("../transport"),f=e("engine.io-parser"),p=e("parseqs"),l=e("yeast"),h=e("../util").pick,t=e("./websocket-constructor"),y=t.WebSocket,d=t.usingBrowserWebSocket,m=t.defaultBinaryType,v=t.nextTick,g="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),t=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(o,u);var t,e,n,r=c(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).supportsBinary=!t.forceBase64,e}return t=o,(e=[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var t=this.uri(),e=this.opts.protocols,n=g?{}:h(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=d&&!g?e?new y(t,e):new y(t):new y(t,e,n)}catch(t){return this.emit("error",t)}this.ws.binaryType=this.socket.binaryType||m,this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws._socket.unref(),e.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}}},{key:"write",value:function(e){var o=this;this.writable=!1;for(var t=0;t<e.length;t++)!function(t){var n=e[t],r=t===e.length-1;f.encodePacket(n,o.supportsBinary,function(t){var e={};d||(n.options&&(e.compress=n.options.compress),o.opts.perMessageDeflate&&("string"==typeof t?b.byteLength(t):t.length)<o.opts.perMessageDeflate.threshold&&(e.compress=!1));try{d?o.ws.send(t):o.ws.send(t,e)}catch(t){}r&&v(function(){o.writable=!0,o.emit("drain")})})}(t)}},{key:"onClose",value:function(){u.prototype.onClose.call(this)}},{key:"doClose",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var t=this.query||{},e=this.opts.secure?"wss":"ws",n="";return this.opts.port&&("wss"==e&&443!==Number(this.opts.port)||"ws"==e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=l()),this.supportsBinary||(t.b64=1),(t=p.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t}},{key:"check",value:function(){return!(!y||"__initialize"in y&&this.name===o.prototype.name)}}])&&i(t.prototype,e),n&&i(t,n),o}();n.exports=t}.call(this)}.call(this,e("buffer").Buffer)},{"../transport":4,"../util":11,"./websocket-constructor":9,buffer:1,"engine.io-parser":18,parseqs:20,yeast:22}],11:[function(t,e,n){"use strict";e.exports.pick=function(n){for(var t=arguments.length,e=new Array(1<t?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return e.reduce(function(t,e){return n.hasOwnProperty(e)&&(t[e]=n[e]),t},{})}},{}],12:[function(t,e,n){"use strict";var r=t("has-cors"),o=t("./globalThis");e.exports=function(t){var e=t.xdomain,n=t.xscheme,t=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&t)return new XDomainRequest}catch(t){}if(!e)try{return new o[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(t){}}},{"./globalThis":2,"has-cors":19}],13:[function(t,e,n){!function(f){"use strict";n.encode=function(t){for(var e=new Uint8Array(t),n=e.length,r="",o=0;o<n;o+=3)r+=f[e[o]>>2],r+=f[(3&e[o])<<4|e[o+1]>>4],r+=f[(15&e[o+1])<<2|e[o+2]>>6],r+=f[63&e[o+2]];return n%3==2?r=r.substring(0,r.length-1)+"=":n%3==1&&(r=r.substring(0,r.length-2)+"=="),r},n.decode=function(t){var e,n,r,o,i=.75*t.length,s=t.length,c=0;"="===t[t.length-1]&&(i--,"="===t[t.length-2]&&i--);for(var i=new ArrayBuffer(i),a=new Uint8Array(i),u=0;u<s;u+=4)e=f.indexOf(t[u]),n=f.indexOf(t[u+1]),r=f.indexOf(t[u+2]),o=f.indexOf(t[u+3]),a[c++]=e<<2|n>>4,a[c++]=(15&n)<<4|r>>2,a[c++]=(3&r)<<6|63&o;return i}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],14:[function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}void 0!==e&&(e.exports=r),r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<r.length;o++)if((n=r[o])===e||n.fn===e){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],15:[function(t,e,n){const r=Object.create(null);r.open="0",r.close="1",r.ping="2",r.pong="3",r.message="4",r.upgrade="5",r.noop="6";const o=Object.create(null);Object.keys(r).forEach(t=>{o[r[t]]=t});e.exports={PACKET_TYPES:r,PACKET_TYPES_REVERSE:o,ERROR_PACKET:{type:"error",data:"parser error"}}},{}],16:[function(t,e,n){const{PACKET_TYPES_REVERSE:r,ERROR_PACKET:o}=t("./commons");var i="function"==typeof ArrayBuffer;let s;i&&(s=t("base64-arraybuffer"));const c=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t;e.exports=(t,e)=>{if("string"!=typeof t)return{type:"message",data:c(t,e)};var n=t.charAt(0);return"b"===n?{type:"message",data:((t,e)=>{if(s){const n=s.decode(t);return c(n,e)}else return{base64:true,data:t}})(t.substring(1),e)}:r[n]?1<t.length?{type:r[n],data:t.substring(1)}:{type:r[n]}:o}},{"./commons":15,"base64-arraybuffer":13}],17:[function(t,e,n){const i=t("./commons")["PACKET_TYPES"],s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),c="function"==typeof ArrayBuffer;const a=(t,e)=>{const n=new FileReader;return n.onload=function(){var t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)};e.exports=({type:t,data:e},n,r)=>{return s&&e instanceof Blob?n?r(e):a(e,r):c&&(e instanceof ArrayBuffer||(o=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(o):o&&o.buffer instanceof ArrayBuffer))?n?r(e instanceof ArrayBuffer?e:e.buffer):a(new Blob([e]),r):r(i[t]+(e||""));var o}},{"./commons":15}],18:[function(t,e,n){const s=t("./encodePacket"),i=t("./decodePacket"),c=String.fromCharCode(30);e.exports={protocol:4,encodePacket:s,encodePayload:(t,n)=>{const r=t.length,o=new Array(r);let i=0;t.forEach((t,e)=>{s(t,!1,t=>{o[e]=t,++i===r&&n(o.join(c))})})},decodePacket:i,decodePayload:(t,e)=>{var n=t.split(c);const r=[];for(let t=0;t<n.length;t++){var o=i(n[t],e);if(r.push(o),"error"===o.type)break}return r}}},{"./decodePacket":16,"./encodePacket":17}],19:[function(t,e,n){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},{}],20:[function(t,e,n){n.encode=function(t){var e,n="";for(e in t)t.hasOwnProperty(e)&&(n.length&&(n+="&"),n+=encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n},n.decode=function(t){for(var e={},n=t.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}},{}],21:[function(t,e,n){var a=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,u=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(t){var e=t,n=t.indexOf("["),r=t.indexOf("]");-1!=n&&-1!=r&&(t=t.substring(0,n)+t.substring(n,r).replace(/:/g,";")+t.substring(r,t.length));for(var o,i=a.exec(t||""),s={},c=14;c--;)s[u[c]]=i[c]||"";return-1!=n&&-1!=r&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(t){var e=t.replace(/\/{2,9}/g,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||e.splice(0,1);"/"==t.substr(t.length-1,1)&&e.splice(e.length-1,1);return e}(s.path),s.queryKey=(e=s.query,o={},e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,e,n){e&&(o[e]=n)}),o),s}},{}],22:[function(t,e,n){"use strict";var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i=64,s={},c=0,a=0;function u(t){for(var e="";e=o[t%i]+e,0<(t=Math.floor(t/i)););return e}function f(){var t=u(+new Date);return t!==r?(c=0,r=t):t+"."+u(c++)}for(;a<i;a++)s[o[a]]=a;f.encode=u,f.decode=function(t){var e=0;for(a=0;a<t.length;a++)e=e*i+s[t.charAt(a)];return e},e.exports=f},{}],23:[function(t,e,n){"use strict";var r=t("./socket");e.exports=function(t,e){return new r(t,e)},e.exports.Socket=r,e.exports.protocol=r.protocol,e.exports.Transport=t("./transport"),e.exports.transports=t("./transports/index"),e.exports.parser=t("engine.io-parser")},{"./socket":3,"./transport":4,"./transports/index":5,"engine.io-parser":18}]},{},[23])(23)}]);